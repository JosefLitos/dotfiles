#!/usr/bin/bash
if [[ -e $2 ]]; then
	src=${2#$PWD/}
else
	cd ~/Music/
	src=$({
		find * -type d
		find Songs -type f
	} | rofi -dmenu -i -p Play -theme-str 'window {width: 50%;}')
fi

(($?)) && exit
pkill -f "mpv --no-audio-display"

if [[ $1 == mpv ]]; then
	echo "$PWD/$src" > /tmp/song
	opts='--no-audio-display --shuffle --loop-playlist --playlist=/tmp/song'
	[[ -f $src ]] && echo "$PWD/${src%/*}" >> /tmp/song && opts+=' --playlist-start=0'
	mpv $opts > /dev/null
else
	rndMusic "$PWD/$src"
fi
