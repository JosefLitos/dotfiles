#!/usr/bin/bash
if [[ -e $2 ]]; then
	src=${2#$PWD/}
else
	cd ~/Music/
	src=$({
		find * -type d
		find Songs -type f
	} | rofi -dmenu -i -p Play -theme-str 'window {width: 50%;}')
fi

(($?)) && exit
pkill -f "mpv --no-audio-display"

if [[ $1 == mpv ]]; then
	if [[ -f $src ]]; then
		mpv --no-audio-display "$src" > /dev/null
		echo "$PWD/${src%/*}" > /tmp/song
	else
		echo "$PWD/$src" > /tmp/song
	fi
	mpv --no-audio-display --shuffle --loop-playlist --playlist=/tmp/song > /dev/null
else
	rndMusic "$PWD/$src"
fi
